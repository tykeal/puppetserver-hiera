---

role: '::role::ldapserver'

openldap::server::globalconf:
  Security:
    value: 'ssf=0'
  TimeLimit:
    value: '15'
  SizeLimit:
    value: '500'
  LogLevel:
    value: 'stats sync'

openldap::server::module:
  syncprov:
    ensure: present

openldap::server::overlay:
  'syncprov on dc=bardicgrove,dc=org':
    options:
      olcSpCheckpoint: '100 10'
      olcSpSessionLog: '150'
  'syncprov on dc=example,dc=com':
    options:
      olcSpCheckpoint: '100 10'
      olcSpSessionLog: '150'

openldap::server::access:
  'to * by dn="cn=syncrepl,dc=bardicgrove,dc=org" on dc=bardicgrove,dc=org':
    access: 'read'
  'to * by dn="cn=syncrepl,dc=example,dc=com" on dc=example,dc=com':
    access: 'read'

openldap::server::schema::definition:
  freeradius:
    source: 'puppet:///modules/profile/ldap/freeradius.schema'
  ldapns:
    source: 'puppet:///modules/profile/ldap/ldapns.schema'
  wso2is:
    source: 'puppet:///modules/profile/ldap/WSO2IS.schema'

openldap::server::schema:
  corba:
    ensure: present
  core:
    ensure: present
  cosine:
    ensure: present
  duaconf:
    ensure: present
  dyngroup:
    ensure: present
  inetorgperson:
    ensure: present
  java:
    ensure: present
  misc:
    ensure: present
  nis:
    ensure: present
  openldap:
    ensure: present
  ppolicy:
    ensure: present
  collective:
    ensure: present
  wso2is:
    ensure: present
  freeradius:
    ensure: present
  ldapns:
    ensure: present

openldap::server::database:
  'dc=bardicgrove,dc=org':
    ensure: present
    backend: 'hdb'
    dboptions:
      dbconfig:
        - 'set_cachesize 0 268435456 1'
        - 'set_lg_regionmax 262144'
        - 'set_lg_bsize 2097152'
      checkpoint: '512 300'
    directory: '/var/lib/ldap/bardicgrove-org'
    limits:
      - 'dn.exact="cn=syncrepl,dc=bardicgrove,dc=org" size=unlimited time=unlimited'
    rootdn: ENC[GPG,hQEMA4i0Em3b1yILAQf+JquTt1lzrLiBslEctymMvBw4SBmOv/1OJreKPR4Y2WSgTyGQwmxoE/jyW8pUqaIh6u2gJd7o/IrLeVgFbGdm6hGgtgn/SRVN61lsNYoUbseABJDljKWn2I2TsiO9IyFvMruNKfVhkey1+GFYTsHTRoZAT5HHvJ3G233LvZEA64Nf2JujPAcbC8TopN6LDtwbSfOCvGBa3VdVUIaoy9XqjCTIdsvRLbg90DAXO1a5PyUgUXm6bGGMfCVb6MI+nfXIyb5YJUIJI8z9dAum19Y6b3h0pyWPvfmHwdCRCqyGGZfJPP5MwFMIb3UoqWP0Z9jsQGJDXEPucSG7Hs7Y3RcXgYUCDAOVosJoWKQPaQEP/3XGe2+YBJcWuJPPiLfs3QeNo/7Uf2LusgGamsLbSdblQ5Jr6svy/YdJFncneY6boaWFg63e0No7zbtm3QujmaZk1TbX3Lt9/N6O17cdYlUA1iSklSDcltJ1hcCrnQya1eQN7TlvOsh7WRfBhyTqVs4gNXlJ3RVaExMMJ9proaZvmsLV5HRi+f9JABJCZxFZtlzzI/8kj7KixKkymNwWFnI+gXtjerGB2harru3VIX59e4OMH2e4shBANnCpe01/8SK2RP8ARx5NjhZdanWS8Pyb176TH100hWQBkBLbj+qBG3P5kF8bQYl+DBRlPBKYGjoYVLoX33mG0Rfpy+0+mfJievC6M+ooy9YC/ITfUf3ocPXL4L+1KgRtCQrz9Edmz0jrd3RvaqRlKDcR+g74VguHQ7d59adNwNxfZf0RUzYVycPGeDkI0Eil9GKNYapiAHzfXKuRgM/b1I9M8GDIZdglruV5+rwJZZQ/vGkziZLZG06LMQdkZ8H5HBbizPySMC9BAG2ZvsM7Ykm6ndykEj8aQzTza5ZZ/Jt2V3uGsJWjHejW78qPatfLpm+vlFt10z+baSunrK593whuw1YlxMPxXEwayj4W7gRhV/Z8m4u2I+2qLa9VUr2Pg0LDZ6ABD5NujduKXhdX+Tn3Jzi+gg84iYwx7wG9+8OPWiYyuDhH0lsBsRC3x0mF3x9Iz1LZYiNJc9GeCOxfd2blcaM43O5T3P5iRfIUPM9HvQMjrx10zLGvUDpkFuSc2k3P5VaBo1kR4zpn/CqsmkCx/6ubWgFPRrUB12VkOMCvNCR7]
    rootpw: ENC[GPG,hQEMA4i0Em3b1yILAQf/Qag+uzuZqN4MtK+6dKY65Ih23tTMavjDwzzhkL+IIaz22X76mm7Jbfoo3SP8nCTmKah6OPh0EJryR1S7yDvHKqF8ySm8NBJkr+OxeJOTkchXiEoaYrpmszqoI1JsJMYV/QBW5JNeQfWt4Avpg8DZ/Aw251RX08DZu/bBZKy0WmKR2m1xmKv234cl8ExKR0E4kCv27Jvy+0E6q9X30cf9B0zO9vTg0i8sAsVtBYqQwAQ/Q+5OklhmZsaGXZu8tFLCvEeTiThqe0gaGV2G6ixKaoeHCiZHfjbPhmhHntQjsyEUK+2QU4oCl9HmRi73vIhvLU4JMyjlj2xCeV8C1wMfb4UCDAOVosJoWKQPaQEP/jPIRAq8MGlnyOUxSAWeWMMjC6Xxfk8Q+NUT5ZleGgoYGK11hQXyDDUM2nQ1qHZZha30y+D0yskFhNmYFbqr3xAEJdCn8Y9rGHVz5gN8ZuJZQhPNhjjKcbD/05rxDpcTMfs60tcABA3Ov+GCIzcdUGebM+sskNqvZ7ytGgDlyKhRdCgua5Id8QvtWxHOEX4wkxW+E3FX1jbAtyMh4KP913mMyQ5AgVTI6QqZhbTsQHvm3Q8k3sRUR1cY4uOLxNEMytiTRMqc+yuSviAu7uyTwt2UaFR3zcdeoIz1DTPEYwBd3hI+afB9U+/K2eezs1+B6m3xH5asGQkcQqz8nt1gOvNVh+oyPMgN7PRZT3BAqE7kwl8IBECzCCbHPQgyNv13BAUvEqp+X/Z6VzJDRKtqEfR2O++pgyosBLHWoeoNPLY0IAe5+bo9VN/kNKp1WTE9FNGuoBoySB/WxfdeXer+uaW2seU3pgeLCPQ5ltfxNXRkgTpRLkOqdvrcMMWyPHFTzK56mWU7ymUfg5A6SWzzZNgFpP//auLQ6MDlGFZcYqFJUdhQAo4GlVsuWaRBd9NKkn6JqspsMJOzCNmu3T1/Rc7+4aww6KAtJFgZ8bUmXy6aSnVMVmhDaRYb45x5KpKo0bxJ9oYZDdl+i1ag9dhzW+XeUXwDQGmzRD4AiSpjyRf90lsBbgAZsp5VWv7QVgKR3WCCGvCqBkuUf3qNbn5JDrke+cf9kwlipNPLL3AtY8bm6VIttcSdgWIDHi5oAugA05J77buxKm9Q/NzrysvvxLqL5ZQosOmXgOiDeTo5]

  'dc=example,dc=com':
    ensure: present
    backend: 'hdb'
    dboptions:
      dbconfig:
        - 'set_cachesize 0 268435456 1'
        - 'set_lg_regionmax 262144'
        - 'set_lg_bsize 2097152'
      checkpoint: '512 300'
    directory: '/var/lib/ldap/example-com'
    limits:
      - 'dn.exact="cn=syncrepl,dc=example,dc=com" size=unlimited time=unlimited'
    rootdn: ENC[GPG,hQEMA4i0Em3b1yILAQgAlNYYimCkmwblNIqFGlWrecZggA5ssFDYRG7TfvqYfJ+8bUlchcSgyYQQDA5fAG/jtJhFYwdmfYQKDIc3t4pNQeOBUbQSvtgXSzpjN5Gxf/njnlmY5WnFF6/+G7zhi2qz9iN6RGpj5VP/n9jO8kzljK/FPwQs07npuql1GipN2CMYv7ySGIvYKd1ieRqNppUEn7TM3ZxbeRAFvghsN1Hp2CWkhdmku8aq/gnT2KwRttAYXO8jLoQHffE3OsfuvFTuMIHxXbjvQ+lIySb6aCKDd5jq5DfN+OtuEosye8rTefvfkkgwYGmm9E10pmDfBp08XiN0PoA8BvHm9AygSnD304UCDAOVosJoWKQPaQEQAMoYJfkdsxYBBS9zCOld+a30cMMY3f1jADbQ4XH1qfG8CcRhEi9iPZ8PHFCNE5RFMuVzcOenz8HGhbA9Zjrgqz8bEl1zQyN+mJhnZgCZl26p0pnLc7OxKPxazLDWlKQ3bdPlpB7x35wx2j4O/5987+cEx1AYqY7Rvg+gG8EGXOPdI82E3dL3kT+g33yelFXEPxAdzgd2FFb00vSfGL74xjTiAwy6jcqURB8lX9ceTWqGt7kWjNpLHAjV9rflALrEUeJpFiVgDItxOnMI6A6aSrikVG/VgPW9UOYDjlp3hkoVArsIkadA3IBqyCdzkndqSHibJIv5BMgqxgmdPmDFasL7AmtiA3HvI+E/gwAhBtYakA6WkDADm7b8hExa+GpJTqx/cDT351MxXJlS9WG/aNfkmVmIlu/yyck7TlsICoFLi5XKIWiQAUf8oF2KCBAsVSF6G1n9O+07oGz2aJPeFPP0gHBR1Q2MsbkPaGzlX70tYgFTiNDmS7wY8d7zgKrT1mB5vXcvw8hLZrXC3MlZ5yQ4uY9X2Lc9S2Ob/OC+0tJTSvTtS8CLbmvDDk7OEtZCeDCE7NZC7SpiPE+j2WbjnwBlUJ0KoVSYWmk3fW7lfNTHCZc0h5q36gnTeT0GSNgiQ0waW1bLQamGTDD3ICE+GQsuc9v5ici2W8gl01TgYDrL0lcBi1//iVAO/pyfqySFg8UTfYY3vuIe4QE8fTOJNxwMSn/I/+ivyN2ibuOOiqVm9zF+3/+p2CEI8y0krruj8clqIe4bHOPWcg0HG6HG8lDGiWaJoBFmsCA=]
    rootpw: ENC[GPG,hQEMA4i0Em3b1yILAQf9FwFD8WY1G+aaeE7W/9ZCuWPIJfiKJuiqb3vpcoR9i62V11xot3yYNuDdzmaCtnjyN18Kgxi+YlKBazh8jVbnM/kJ81iN9FcfwvXrZWeWtwl7kpW/6q3UZj0VZfmnt/PdbnxojvuJGsEVn1ri81IioA1vCUzAkQ76+fjNzpSHTnt95j5FXPtzhj+8Ria8ch9VYAcUsTJcm7wDq2HA5i0tMbPH/uG1YbIkFURHMKJzovH9U3kJLylIUvI/y/8Pc9LiQNbNFNtNliJtxxEH81K6b+WgwjM2cTiZm3a4u1avkWNc7rxccYhZLZC+Qq5EUgdPZMBVYD7jRRS99hoMFfJluoUCDAOVosJoWKQPaQEP/3qIrUiONoH/5dE7WxG5D5i0GkI86njLcPAB5LMkxqA5JddUBho5bMqHBG4Mc3dogLe8peIZJE75YiPK2xZLFwF1yIWWSqC95vR3FxerVoq2BunG8KbE/vZ9+TQjCwPFKr7KokPkvZNCT69odEVAoI6C6MVNtCySoTedEcl4tAyQXjLBdTdVUhWLkMztd4ki8Rfk08PmTvWJfMewUNDDM7rocc6NT1wdY1f8CiT6qxQIuM8C2jlWuVWrsj+omZEnqgfjJFTIW0eqS46Jw3K3ZBxKCKG8SzrWpzNsZoEIuXbtIg+twGbh3n0eyY2DSXnGE9jAk/1hzn+LuRSe0eTCriZU8RFDPzl/4RBFi2NT8yClwaN/7uHOKW3rQeyjRFB9XyYQOVCXXDA4ZxM1vRdKhVKoGRrRg9+hmJ6CHfuVJbnA1k3Sgm4Hn7fxY+5kdLW7Az436Ej3gzJaychREWBnFohXKnvDhlicPt1UuKAES0TLGLU2+rOrZUlJUNuD6asvJcMb20GucKrRhxSpktlafUhc67rulXLNqGrPF+cWgAZTKnF/Q//yo5Qj+Yi5G7kofOlhGY1Q+PwYsnie+JOCK4wQs41HKNEKR8gPMc+as3XC+LPUrAp/NDAyqkK1AGO6tEfXtLkZRBwShNfrW7Fhjjf9DJ2axCwKaunLQbGEppAN0lsBD+9PST6bEJmHCCpYQ6fI0IlwNobdkQ/aeUhC7gc4i939/v55xukrGXuH8g6JTSAc7nScls7ILrjga5FT3JNWrCaNc8A27ndXESs+ZoAKDkW4rHu4Ld8udEqj]

openldap::server::dbindex:
  'entryUUID on dc=bardicgrove,dc=org':
    indices: 'eq'
  'uid on dc=bardicgrove,dc=org':
    indices: 'eq,pres,sub'
  'cn on dc=bardicgrove,dc=org':
    indices: 'eq,pres,sub'
  'mail on dc=bardicgrove,dc=org':
    indices: 'eq,pres,sub'
  'sn on dc=bardicgrove,dc=org':
    indices: 'eq,pres,sub'
  'givenName on dc=bardicgrove,dc=org':
    indices: 'eq,pres,sub'
  'member on dc=bardicgrove,dc=org':
    indices: 'eq'
  'uniqueMember on dc=bardicgrove,dc=org':
    indices: 'eq'
  'uidNumber on dc=bardicgrove,dc=org':
    indices: 'eq,pres'
  'gidNumber on dc=bardicgrove,dc=org':
    indices: 'eq,pres'
  'dialupAccess on dc=bardicgrove,dc=org':
    indices: 'eq'

  'entryUUID on dc=example,dc=com':
    indices: 'eq'
  'uid on dc=example,dc=com':
    indices: 'eq,pres,sub'
  'cn on dc=example,dc=com':
    indices: 'eq,pres,sub'
  'mail on dc=example,dc=com':
    indices: 'eq,pres,sub'
  'sn on dc=example,dc=com':
    indices: 'eq,pres,sub'
  'givenName on dc=example,dc=com':
    indices: 'eq,pres,sub'
  'member on dc=example,dc=com':
    indices: 'eq'
  'uniqueMember on dc=example,dc=com':
    indices: 'eq'
  'uidNumber on dc=example,dc=com':
    indices: 'eq,pres'
  'gidNumber on dc=example,dc=com':
    indices: 'eq,pres'
  'dialupAccess on dc=example,dc=com':
    indices: 'eq'

# vim: ts=2 sw=2 sts=2 et :
